(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d068"],{f679:function(e,t,i){"use strict";i("8449"),i("7f7f"),i("c5f6");var a=i("5530"),r=(i("ac6a"),i("d4ec")),l=i("bee2"),o=i("024c"),s=i.n(o),n=i("828a"),h=i.n(n),c=(i("5df3"),i("1c4c"),3.141592653589793),g=6378245,p=.006693421622965943;function k(e,t){if(f(e,t))return[e,t];var i=u(e-105,t-35),a=y(e-105,t-35),r=t/180*c,l=Math.sin(r);l=1-p*l*l;var o=Math.sqrt(l);i=180*i/(g*(1-p)/(l*o)*c),a=180*a/(g/o*Math.cos(r)*c);var s=t+i,n=e+a;return[n,s]}function u(e,t){var i=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*c)+20*Math.sin(2*e*c))/3,i+=2*(20*Math.sin(t*c)+40*Math.sin(t/3*c))/3,i+=2*(160*Math.sin(t/12*c)+320*Math.sin(t*c/30))/3,i}function y(e,t){var i=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*c)+20*Math.sin(2*e*c))/3,i+=2*(20*Math.sin(e*c)+40*Math.sin(e/3*c))/3,i+=2*(150*Math.sin(e/12*c)+300*Math.sin(e/30*c))/3,i}function f(e,t){return!(e>73.66&&e<135.05&&t>3.86&&t<53.55)}var d=function(){function e(t){Object(r["a"])(this,e),this.map=null,this.mapId=t.mapId||"map",this.initCenter=t.initCenter||[114.170474,22.627021],this.initZoom=t.initZoom||11,this.choseZoom=t.choseZoom||17,this.wms=null,this.borderLayer=null,this.lastMarker=null,this.lastMarkerColor=null,this.circleMarkers={},this.polygons={},this.lastPolygonMarker={},this.textMarkers={},this.iconMarkers={},this.lastIconMarker=null,this.lastIconMarkerOption=null,this.lastLineMarker=null,this.lastLineMarkerOption=null,this.massMarkers={},this.lastMassMarker=null,this.lastMassMarkerOption={},this.htmlMarkers={},this.currentHtmlMarker={},this.pointCloudLayer=null,this.clusterLayer=null,this.markers={},this.lineMarkers={},this.object3Dlayer=null,this.areaText={},this.lableText=null}return Object(l["a"])(e,[{key:"initMap",value:function(){this.map=new s.a.Map(this.mapId,{center:this.initCenter,mapStyle:"amap://styles/e434399121bb5d4fbea1ac2ab6079717",resizeEnable:!0,zooms:[10,18],zoom:this.initZoom})}},{key:"init3DLayer",value:function(){if(!this.object3Dlayer){var e=this.object3Dlayer=new s.a.Object3DLayer({zIndex:1e3});this.map.add(e)}}},{key:"addPrism",value:function(e){this.init3DLayer();var t=this;e.forEach((function(e){var i=t.lngLatArray(e["path"]),a=10,r="#0088ff",l=new s.a.Object3D.Prism({path:i,height:a,width:50,color:r});t.object3Dlayer.add(l)}))}},{key:"setCenter",value:function(e){this.map.setCenter(e)}},{key:"getOption",value:function(e,t){return Object.assign(Object(a["a"])({},e),t)}},{key:"initMask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getOption({wgs84togcj02:!1,strokeColor:"#00eeff",strokeWeight:1,fillColor:"#04101e",fillOpacity:.7},t),a=[new s.a.LngLat(-360,90,!0),new s.a.LngLat(-360,-90,!0),new s.a.LngLat(360,-90,!0),new s.a.LngLat(360,90,!0)],r=[];e.forEach((function(e){var t=[];e.forEach((function(e){if(i.wgs84togcj02){var a=k(e[0],e[1]);t.push(new s.a.LngLat(a[0],a[1],!0))}else t.push(new s.a.LngLat(e[0],e[1],!0))})),r.push(t)}));var l=[a];l.push.apply(l,r);var o=new s.a.Polygon({pathL:l,strokeColor:i.strokeColor||"#00eeff",strokeWeight:i.strokeWeight||1,fillColor:i.fillColor||"#04101e",fillOpacity:i.fillOpacity||.7});o.setPath(l),this.map.add(o)}},{key:"initAreaBorder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getOption({lnglat:"coordinates",opacity:1,borderWidth:3,color:function(e){return"#225ea800"},borderColor:"#418BC2"},t);this.borderLayer=new h.a.PolygonLayer({map:this.map}),this.borderLayer.setData(e,{lnglat:i.lnglat||"coordinates"}),this.borderLayer.setOptions({style:{opacity:i.opacity||1,borderWidth:i.borderWidth||3,color:i.color,borderColor:i.borderColor||"#418BC2"}}),this.borderLayer.render()}},{key:"initWmsGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.wms){var t=this.getOption({url:"",blend:!1,zooms:[10,18],tileSize:256,params:{LAYERS:"sums_ksh:area_gd_sys",FORMAT:"image/png",SRS:"EPSG:3857"}},e);this.wms=new s.a.TileLayer.WMS({url:t.url,blend:t.blend,zooms:t.zooms||[10,18],tileSize:t.tileSize||256,params:t.params}),this.wms.setMap(this.map)}}},{key:"clearWmsGrid",value:function(){this.wms&&(this.wms.setMap(null),this.wms=null)}},{key:"addWmsLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getOption({type:"default",url:"https://smartum.sz.gov.cn/szcg/geoServerApi/geoserver/sums_ksh/wms",blend:!1,zooms:[10,18],tileSize:256,params:{LAYERS:"sums_ksh:area_gd_sys",FORMAT:"image/png",SRS:"EPSG:3857"},clearFlag:!0},e);this.wmss[t.type]&&t.clearFlag&&this.clearWmsLayer(t.type),this.wmss[t.type]=new s.a.TileLayer.WMS({url:t.url,blend:t.blend||!1,zooms:t.zooms||[10,18],tileSize:t.tileSize||256,params:t.params||{LAYERS:"sums_ksh:area_gd_sys",FORMAT:"image/png",SRS:"EPSG:3857"}}),this.wmss[t.type].setMap(this.map)}},{key:"clearWmsLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.wmss[e]&&(this.wmss[e].setMap(null),this.wmss[e]=null)}},{key:"addCircleMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({type:"default",fillColor:"rgba(0,255,255,1)",fillOpacity:1,radius:7,clickColor:"rgba(235,97,0,1)",clickFlag:!0,fitViewFlag:!1,clearFlag:!0,showFlag:!0,callback:function(){}},i);void 0===this.circleMarkers[a.type]&&(this.circleMarkers[a.type]=[]),a.clearFlag&&this.clearCircleMarkers(a.type),e.forEach((function(e){var i=[Number(e.lng),Number(e.lat)];e.markerType=a.type;var r=new s.a.CircleMarker({center:i,radius:a.radius||7,strokeColor:"white",strokeWeight:0,strokeOpacity:a.strokeOpacity||0,fillColor:a.fillColor||"rgba(0,255,255,1)",fillOpacity:a.fillOpacity||1,zIndex:10,bubble:!0,cursor:"pointer",clickable:!0,extData:e});a.clickFlag&&r.on("click",(function(e){null!==t.lastMarker&&t.lastMarker.target.setOptions({map:t.map,fillColor:t.lastMarkerColor||"rgba(0,255,255,1)"}),t.lastMarkerColor=e.target.getOptions().fillColor,e.target.setOptions({map:t.map,fillColor:a.clickColor}),t.lastMarker=e,a.callback(e.target.getExtData())})),t.circleMarkers[a.type].push(r)})),this.map.add(this.circleMarkers[a.type]),a.fitViewFlag&&this.map.setFitView()}},{key:"clearCircleMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";null!==this.lastMarker&&(this.map.remove(this.lastMarker),this.lastMarker=null),this.circleMarkers[e]&&this.circleMarkers[e].length>0&&(this.map.remove(this.circleMarkers[e]),this.circleMarkers[e]=[])}},{key:"addPolygonMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({type:"default",strokeStyle:"solid",strokeColor:"#10CADA",strokeDasharray:[5,3],strokeWeight:2,strokeOpacity:1,fillColor:"#1BB2D9",fillOpacity:.2,path:"path",highLightFillColor:"#10CADA",highLightFillOpacity:0,setFitView:!0,clickFlag:!0,clearFlag:!0,highLight:!1,showLabel:!0,callback:function(){}},i);void 0===this.polygons[a.type]&&(this.polygons[a.type]=[]),a.clearFlag&&this.clearPolygonMarkers(a.type),e.forEach((function(e){a.showLabel?t.lableText=new s.a.Text({zIndex:a.zIndex||50,text:e.name,position:e.c_point,style:{padding:"5px 10px","background-color":"#001014",border:"1px solid #0b6a6b","text-align":"center","font-size":"12px",color:"#fff"}}):t.lableText=null;var i=new s.a.Polygon({path:e[a.path],strokeStyle:a.strokeStyle,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,strokeDasharray:a.strokeDasharray,fillOpacity:a.fillOpacity,fillColor:a.fillColor,zIndex:a.zIndex||50,extData:e});i.name=e.name,i.adcode=e.adcode,i.original=e,a.clickFlag&&i.on("click",(function(r){a.highLight&&(void 0===t.lastPolygonMarker[a.type]||t.lastPolygonMarker[a.type].setOptions({fillOpacity:a.fillOpacity,fillColor:a.fillColor}),t.lastPolygonMarker[a.type]=i,i.setOptions({fillOpacity:a.highLightFillOpacity,fillColor:a.highLightFillColor})),a.callback(e)})),t.polygons[a.type].push(i),a.showLabel&&t.lableText.setMap(t.map)})),this.map.add(this.polygons[a.type]),a.setFitView&&this.map.setFitView()}},{key:"highLightPolygonMarkerByData",value:function(e,t,i,a){var r=this,l=this.getOption({type:"default",strokeStyle:"solid",strokeColor:"#10CADA",strokeDasharray:[5,3],strokeWeight:2,strokeOpacity:1,fillColor:"#1BB2D9",fillOpacity:.2,path:"path",highLightFillColor:"#10CADA",highLightFillOpacity:0,setFitView:!0,clickFlag:!0,clearFlag:!0,highLight:!1,callback:function(){}},t);this.polygons[e]&&this.polygons[e].length&&this.polygons[e].forEach((function(e){var t=e.getExtData();t[a]===i&&l.highLight&&(void 0===r.lastPolygonMarker[l.type]||r.lastPolygonMarker[l.type].setOptions({fillOpacity:l.fillOpacity,fillColor:l.fillColor}),r.lastPolygonMarker[l.type]=e,e.setOptions({fillOpacity:l.highLightFillOpacity,fillColor:l.highLightFillColor}),r.movePoint(e.getBounds().getCenter()))}))}},{key:"clearMap",value:function(){this.clearAllMapData(),this.map.clearMap()}},{key:"clearPolygonMarkers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.polygons[t]&&this.polygons[t].length>0&&(this.polygons[t].forEach((function(t){e.map.remove(t)})),this.polygons[t]=[])}},{key:"clearAllPolygonMarkers",value:function(){for(var e in this.polygons)this.polygons[e]&&this.polygons[e].length>0&&(this.clearPolygonMarkers(e),delete this.polygons[e])}},{key:"hidePolygonMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.polygons[e]&&this.polygons[e].length>0&&this.polygons[e].forEach((function(e){e.hide()}))}},{key:"resetPolygonMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getOption({type:"default",strokeStyle:"solid",strokeColor:"#10CADA",strokeDasharray:[5,3],strokeWeight:2,strokeOpacity:1,fillColor:"#1BB2D9",fillOpacity:.2,path:"path",highLightFillColor:"#10CADA",highLightFillOpacity:0,clickFlag:!0,clearFlag:!0,highLight:!1,callback:function(){}},t);this.polygons[e].forEach((function(e){e.setOptions({strokeColor:i.strokeColor,fillOpacity:i.highLightFillOpacity,fillColor:i.highLightFillColor})}))}},{key:"highLightPolygonMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var i=this.getOption({type:"default",strokeStyle:"solid",strokeColor:"#10CADA",strokeDasharray:[5,3],strokeWeight:2,strokeOpacity:1,fillColor:"#1BB2D9",fillOpacity:.2,path:"path",highLightFillColor:"#10CADA",highLightFillOpacity:0,clickFlag:!0,clearFlag:!0,highLight:!1,callback:function(){}},t);e.setOptions({strokeColor:i.strokeColor,fillOpacity:i.fillOpacity,fillColor:i.fillColor})}}},{key:"clearPolygonHighLight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var i=this.getOption({type:"default",strokeStyle:"solid",strokeColor:"#10CADA",strokeDasharray:[5,3],strokeWeight:2,strokeOpacity:1,fillColor:"#1BB2D9",fillOpacity:.2,path:"path",highLightFillColor:"#10CADA",highLightFillOpacity:0,clickFlag:!0,clearFlag:!0,highLight:!1,callback:function(){}},t);e.setOptions({strokeColor:i.strokeColor,fillOpacity:i.highLightFillOpacity,fillColor:i.highLightFillColor})}}},{key:"showPolygonMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.polygons[e]&&this.polygons[e].length>0&&this.polygons[e].forEach((function(e){e.show()}))}},{key:"addTextMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({type:"default",labelTarget:"name",anchor:"center",draggable:!1,cursor:"pointer",angle:0,style:{width:"200px",borderWidth:0,background:"transparent",textAlign:"center",fontSize:"14px",fontWeight:"400",color:"#FFF"},position:[114.28317,22.690627],clickFlag:!0,fitViewFlag:!1,clearFlag:!0,callback:function(){}},i);void 0===this.textMarkers[a.type]&&(this.textMarkers[a.type]=[]),a.clearFlag&&this.clearTextMarkers(a.type),e.forEach((function(e){console.log("label>","".concat(e[a.labelTarget]));var i=new s.a.Text({text:"".concat(e[a.labelTarget]),zIndex:a.zIndex||50,anchor:a.anchor||"center",draggable:a.draggable||!1,cursor:a.cursor||"pointer",angle:a.angle||0,style:{width:a.style.width||"4rem",borderWidth:a.style.borderWidth||0,background:a.style.background||"transparent",textAlign:a.style.textAlign||"center",fontSize:a.style.fontSize||"0.73rem",fontWeight:a.style.fontWeight||"900",color:a.style.color||"#FFF"},position:[e.position[0],e.position[1]]||!1,extData:e});a.clickFlag&&i.on("click",(function(e){a.callback(e.target.getExtData(),a)})),t.textMarkers[a.type].push(i)})),this.map.add(this.textMarkers[a.type]),a.fitViewFlag&&this.map.setFitView()}},{key:"clearTextMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.textMarkers[e]&&this.textMarkers[e].length>0&&(this.map.remove(this.textMarkers[e]),this.textMarkers[e]=[])}},{key:"hideTextMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.textMarkers[e]&&this.textMarkers[e].length>0&&this.textMarkers[e].forEach((function(e){e.hide()}))}},{key:"showTextMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.textMarkers[e]&&this.textMarkers[e].length>0&&this.textMarkers[e].forEach((function(e){e.show()}))}},{key:"addIconMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({img:null,size:[15,15],selectedSize:[78,70],selectOffset:[38,45],offset:[0,0],pixel:[0,0],type:"default",clickFlag:!0,fitViewFlag:!0,clearFlag:!0,showLabel:!1,labelTarget:"name",zIndex:6e3,callback:function(){}},i);a.selectOffset||(a.selectOffset=a.offset),void 0===this.iconMarkers[a.type]&&(this.iconMarkers[a.type]=[]),a.clearFlag&&this.clearIconMarkers(a.type),e.forEach((function(e){if(e.lng&&e.lat){e.markerType=a.type||"default";var i=new s.a.Icon({size:new s.a.Size(a.size[0],a.size[1]),image:a.img,imageOffset:new s.a.Pixel(a.pixel[0],a.pixel[1]),imageSize:new s.a.Size(a.size[0],a.size[1])}),r=new s.a.Marker({position:new s.a.LngLat(Number(e.lng),Number(e.lat)),offset:new s.a.Pixel(a.offset[0],a.offset[1]),icon:i,title:e.name||e.facilityName||"",zoom:11,extData:e,zIndex:a.zIndex});a.clickFlag&&r.on("click",(function(i){if(null!==t.lastIconMarker){var l=new s.a.Icon({size:new s.a.Size(t.lastIconMarkerOption.size[0],t.lastIconMarkerOption.size[1]),image:t.lastIconMarkerOption.img,imageOffset:new s.a.Pixel(t.lastIconMarkerOption.pixel[0],t.lastIconMarkerOption.pixel[1]),imageSize:new s.a.Size(t.lastIconMarkerOption.size[0],t.lastIconMarkerOption.size[1])});t.lastIconMarker.setIcon(l)}t.lastIconMarker=r,t.lastIconMarkerOption=a;var o=new s.a.Icon({size:new s.a.Size(a.selectedSize[0],a.selectedSize[1]),image:a.selectedOption,imageOffset:new s.a.Pixel(a.pixel[0],a.pixel[1]),imageSize:new s.a.Size(a.selectedSize[0],a.selectedSize[1])});r.setIcon(o),r.setOffset(new s.a.Pixel(a.selectOffset[0],a.selectOffset[1])),console.log(e.lng+","+e.lat),t.movePoint(new s.a.LngLat(Number(e.lng),Number(e.lat))),t.zoom(t.choseZoom),a.callback(i.target.getExtData(),a)})),a.showLabel&&r.setLabel({offset:new s.a.Pixel(0,0),content:e[a.labelTarget]||e.facilityName||"",direction:"top"}),t.iconMarkers[a.type].push(r)}})),this.map.add(this.iconMarkers[a.type]),a.fitViewFlag&&this.map.setFitView()}},{key:"hightLightIconMarkerByData",value:function(e,t,i,a){var r=this,l=this.getOption({img:null,size:[15,15],selectedSize:[78,70],offset:[0,0],pixel:[0,0],type:"default",clickFlag:!0,fitViewFlag:!1,clearFlag:!0,showLabel:!1,zIndex:6e3,callback:function(){}},t);this.iconMarkers[e]&&this.iconMarkers[e].length&&this.iconMarkers[e].forEach((function(e){var t=e.getExtData();if(i===t[a]){if(console.log("selected:",t),null!==r.lastIconMarker){var o=new s.a.Icon({size:new s.a.Size(r.lastIconMarkerOption.size[0],r.lastIconMarkerOption.size[1]),image:r.lastIconMarkerOption.img,imageOffset:new s.a.Pixel(r.lastIconMarkerOption.pixel[0],r.lastIconMarkerOption.pixel[1]),imageSize:new s.a.Size(r.lastIconMarkerOption.size[0],r.lastIconMarkerOption.size[1])});r.lastIconMarker.setIcon(o)}var n=new s.a.Icon({size:new s.a.Size(l.selectedSize[0],l.selectedSize[1]),image:l.selectedOption,imageOffset:new s.a.Pixel(l.pixel[0],l.pixel[1]),imageSize:new s.a.Size(l.selectedSize[0],l.selectedSize[1])});e.setIcon(n),e.setOffset(new s.a.Pixel(l.selectOffset[0],l.selectOffset[1])),r.lastIconMarker=e,r.lastIconMarkerOption=l,console.log(e.getPosition()),r.movePoint(e.getPosition())}}))}},{key:"clearIconMarkers",value:function(e){this.iconMarkers[e]&&this.iconMarkers[e].length>0&&(this.map.remove(this.iconMarkers[e]),this.iconMarkers[e]=[])}},{key:"clearAllIconMarkers",value:function(){for(var e in this.iconMarkers)this.iconMarkers[e]&&this.iconMarkers[e].length>0&&(this.map.remove(this.iconMarkers[e]),delete this.iconMarkers[e])}},{key:"addLineMarkers",value:function(e,t){var i=this,a=this.getOption({path:"path",strokeColor:"green",strokeOpacity:.4,strokeWeight:3,hightLightBorderWeight:3,hightLightStrokeColor:"red",lineJoin:"round",borderWeight:3,isOutline:!0,outlineColor:"#29f07f",cursor:"pointer",type:"default",clickFlag:!0,isChecked:!1,fitViewFlag:!0,clearFlag:!0,highLightFlag:!0,showLabel:!1,zIndex:6e3,callback:function(){}},t);void 0===this.lineMarkers[a.type]&&(this.lineMarkers[a.type]=[]),a.clearFlag&&this.clearLineMarkers(a.type),e.forEach((function(e){var t=i.lngLatArray(e[a.path]),r=new s.a.Polyline({path:t,borderWeight:a.borderWeight,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight,outlineColor:a.outlineColor,isOutline:a.isOutline,cursor:a.cursor,extData:e,lineJoin:a.lineJoin});r.on("click",(function(e){a.isChecked=!0,null!==i.lastLineMarker&&(i.lastLineMarker.setOptions({borderWeight:i.lastLineMarkerOption.hightLightBorderWeight,strokeColor:i.lastLineMarkerOption.strokeColor,strokeOpacity:i.lastLineMarkerOption.strokeOpacity}),i.lastLineMarkerOption.isChecked=!1),i.lastLineMarker=r,i.lastLineMarkerOption=a,r.setOptions({borderWeight:a.hightLightBorderWeight,strokeColor:a.hightLightStrokeColor,strokeOpacity:.8}),a.callback(e.target.getExtData(),a)})),a.highLightFlag&&(r.on("mouseover",(function(e){a.isChecked||r.setOptions({borderWeight:a.hightLightBorderWeight,strokeColor:a.hightLightStrokeColor})})),r.on("mouseout",(function(e){a.isChecked||r.setOptions({borderWeight:a.borderWeight,strokeColor:a.strokeColor})}))),i.lineMarkers[a.type].push(r)})),this.map.add(this.lineMarkers[a.type]),a.fitViewFlag&&this.map.setFitView()}},{key:"clearLineMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.lineMarkers[e]&&this.lineMarkers[e].length>0&&(this.map.remove(this.lineMarkers[e]),this.lineMarkers[e]=[])}},{key:"lngLatArray",value:function(e){var t=[];return e.forEach((function(e){t.push(new s.a.LngLat(e.lng,e.lat))})),t}},{key:"hightLightLineByData",value:function(e,t,i,a){var r=this,l=this.getOption({path:"path",strokeColor:"green",strokeOpacity:.4,strokeWeight:3,hightLightBorderWeight:3,hightLightStrokeColor:"red",lineJoin:"round",borderWeight:3,isOutline:!0,outlineColor:"#29f07f",cursor:"pointer",type:"default",clickFlag:!0,isChecked:!1,fitViewFlag:!0,clearFlag:!0,highLightFlag:!0,showLabel:!1,zIndex:6e3,callback:function(){}},t);this.lineMarkers[e]&&this.lineMarkers[e].length&&this.lineMarkers[e].forEach((function(e){var t=e.getExtData();i===t[a]&&(console.log("selected:",t),null!==r.lastLineMarker&&(r.lastLineMarker.setOptions({borderWeight:r.lastLineMarkerOption.hightLightBorderWeight,strokeColor:r.lastLineMarkerOption.hightLightStrokeColor,strokeOpacity:r.lastLineMarkerOption.strokeOpacity,strokeWeight:r.lastLineMarkerOption.strokeWeight,outlineColor:r.lastLineMarkerOption.outlineColor,isOutline:r.lastLineMarkerOption.isOutline}),r.lastLineMarkerOption.isChecked=!0),e.setOptions({borderWeight:l.hightLightBorderWeight,strokeColor:l.hightLightStrokeColor,strokeOpacity:.8}),r.lastLineMarker=e,r.lastLineMarkerOption=l,r.map.setFitView())}))}},{key:"addMassMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({img:null,selectImg:null,size:[15,15],selectedSize:[78,70],pixel:[6,6],type:"default",clickFlag:!0,clearFlag:!0,fitViewFlag:!0,clickType:"",callback:function(){}},i);a.clearFlag&&this.clearMassMarkers(a.type),e.forEach((function(e){e.style=0}));var r={url:a.img,size:new s.a.Size(a.size[0],a.size[1]),anchor:new s.a.Pixel(a.pixel[0],a.pixel[1])},l={url:a.selectImg,size:new s.a.Size(a.selectedSize[0],a.selectedSize[1]),anchor:new s.a.Pixel(a.pixel[0],a.pixel[1])},o=[r,l];this.massMarkers[a.type]=new s.a.MassMarks(e,{zIndex:5e3,zooms:[10,19],style:o}),this.massMarkers[a.type].setMap(this.map),a.clickFlag&&this.massMarkers[a.type].on("click",(function(e){null!==t.lastMassMarker&&(t.lastMassMarker.style=0),console.log("e>",e),t.lastMassMarker=e.data,t.lastMassMarkerOption=a,e.data.style=1,t.movePoint(e.data.lnglat),a.callback(e.data)})),this.movePoint(e[0].lnglat),a.fitViewFlag&&this.map.setFitView()}},{key:"hightLightMassMarkerByData",value:function(e,t,i,a){var r=this,l=this.getOption({img:null,selectImg:null,size:[15,15],selectedSize:[78,70],pixel:[6,6],type:"default",clickFlag:!0,clearFlag:!0,fitViewFlag:!0,clickType:"",callback:function(){}},t),o=this.massMarkers[e].getData();o&&o.length>0&&o.forEach((function(e){i===e[a]&&(console.log("selected:",e),null!==r.lastMassMarker&&(r.lastMassMarker.style=0),e.style=1,r.lastMassMarker=e,r.lastMassMarker.lastIconMarkerOption=l,r.movePoint(e.lnglat))}))}},{key:"clearAllMassMarkers",value:function(){for(var e in this.massMarkers)this.clearMassMarkers(e)}},{key:"clearMassMarkers",value:function(e){this.massMarkers[e]&&(this.massMarkers[e].clear(),this.massMarkers[e]=void 0)}},{key:"addHtmlMarkers",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!e.length)return!1;var a=this.getOption({pixel:[6,6],type:"default",clickFlag:!0,clearFlag:!0,callback:function(){}},i);this.currentHtmlMarker={data:e,option:a},void 0===this.htmlMarkers[a.type]&&(this.htmlMarkers[a.type]=[]),a.clearFlag&&this.clearHtmlMarkers(a.type),e.forEach((function(e){var i=new s.a.Marker({content:e.content||" ",position:e.position||e.center||[0,0],offset:new s.a.Pixel(a.pixel[0],a.pixel[1]),extData:e});a.clickFlag&&i.on("click",(function(e){a.callback(e.target.getExtData(),a)})),t.htmlMarkers[a.type].push(i)})),this.map.add(this.htmlMarkers[a.type])}},{key:"clearHtmlMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.htmlMarkers[e]&&this.htmlMarkers[e].length>0&&(this.map.remove(this.htmlMarkers[e]),this.htmlMarkers[e]=[],this.currentHtmlMarker={})}},{key:"setZoom",value:function(e){this.map.setZoom(e||this.initZoom)}},{key:"addPointCloudLayer",value:function(e,t){var i=this.getOption({type:"json",lnglat:"lnglat",style:{radius:.5,color:"rgb(42, 167, 184)",opacity:.5},fitView:!1},t);this.pointCloudLayer=new h.a.PointCloudLayer({map:this.map,fitView:i.fitView}),this.pointCloudLayer.setData(e,{lnglat:i.lnglat,type:i.type}).setOptions({style:i.style}).render()}},{key:"clearPointCloudLayer",value:function(){this.pointCloudLayer&&(this.pointCloudLayer.setMap(null),this.pointCloudLayer=null)}},{key:"addHeatmapLayer",value:function(e,t){var i=this.getOption({value:"json",lnglat:"lnglat",style:{radius:20,color:{.5:"#2c7bb6",.65:"#abd9e9",.7:"#ffffbf",.9:"#fde468",1:"#d7191c"}},fitView:!1},t);this.heatmapLayer=new h.a.HeatmapLayer({map:this.map,fitView:i.fitView}),this.heatmapLayer.setData(e,{lnglat:i.lnglat,value:i.value}).setOptions({style:i.style}).render()}},{key:"clearHeatmapLayer",value:function(){this.heatmapLayer.setMap(null)}},{key:"addClusterLayer",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getOption({gridSize:20,size:[15,15],pixel:[6,6],type:"cluster",clickFlag:!0,clearFlag:!0,clickType:"",callback:function(){},_renderClusterMarker:function(t){var i=Math.pow(t.count/e.length,1/18),a=document.createElement("div"),r=180-180*i,l="hsla("+r+",100%,50%,0.7)",o="hsla("+r+",100%,20%,1)",n="hsla("+r+",100%,40%,1)",h="hsla("+r+",100%,50%,1)";a.style.backgroundColor=l;var c=Math.round(30+20*Math.pow(t.count/e.length,.2));a.style.width=a.style.height=c+"px",a.style.border="solid 1px "+n,a.style.borderRadius=c/2+"px",a.style.boxShadow="0 0 1px "+h,a.innerHTML=t.count,a.style.lineHeight=c+"px",a.style.color=o,a.style.fontSize="14px",a.style.textAlign="center",t.marker.setOffset(new s.a.Pixel(-c/2,-c/2)),t.marker.setContent(a)}},i);void 0===this.markers[a.type]&&(this.markers[a.type]=[]),a.clearFlag&&this.clusterLayer&&this.clusterLayer.clearMarkers(),e.forEach((function(e){var i=new s.a.Marker({content:e.content||" ",position:e.position||e.center||[e.lng,e.lat]||[0,0],offset:new s.a.Pixel(a.pixel[0],a.pixel[1]),extData:e});a.clickFlag&&i.on("click",(function(e){a.callback(e.target.getExtData(),a)})),t.markers[a.type].push(i)})),s.a.plugin(["AMap.MarkerClusterer"],(function(){t.clusterLayer=new s.a.MarkerClusterer(t.map,t.markers[a.type],{gridSize:a.gridSize,renderClusterMarker:a._renderClusterMarker})}))}},{key:"clearClusterLayer",value:function(){this.clusterLayer.clearMarkers()}},{key:"getLine",value:function(e){for(var t=[],i=-6e-5,a=6e-5,r=0;r<e.length;r++){var l=[];l.push(e[r][0]-i),l.push(e[r][1]-a),t.push(l)}return t}},{key:"startPlayTrace",value:function(e){var t=new s.a.Marker({map:this.map,icon:e.img,offset:new s.a.Pixel(-26,-13),autoRotation:!0,angle:-90}),i=this.getLine(e.lineArr),a=this.getLine(i),r=this.getLine(a);new s.a.Polyline({map:this.map,path:r,showDir:!0,isOutline:!0,borderWeight:1,strokeColor:"#189550",outlineColor:"#39ee87",strokeOpacity:.1,strokeWeight:16,strokeStyle:"solid"}),new s.a.Polyline({map:this.map,path:a,showDir:!0,isOutline:!0,borderWeight:2,strokeColor:"#189550",outlineColor:"#39ee87",strokeOpacity:.4,strokeWeight:16,strokeStyle:"solid"}),new s.a.Polyline({map:this.map,path:i,showDir:!0,isOutline:!0,borderWeight:3,strokeColor:"#189550",outlineColor:"#39ee87",strokeOpacity:.7,strokeWeight:16,strokeStyle:"solid"}),new s.a.Polyline({map:this.map,path:e.lineArr,showDir:!0,isOutline:!0,borderWeight:4,strokeColor:"#189550",outlineColor:"#39ee87",strokeOpacity:.9,strokeWeight:16,strokeStyle:"solid"});var l=new s.a.Polyline({map:this.map,strokeColor:"#ccc",borderWeight:2,strokeWeight:13});t.on("moving",(function(e){l.setPath(e.passedPath)})),this.map.setFitView(),t.moveAlong(e.lineArr,200)}},{key:"addListener",value:function(e,t){return s.a.event.addListener(this.map,e,(function(e){t(e)}))}},{key:"removeListener",value:function(e){s.a.event.removeListener(e)}},{key:"panBy",value:function(e,t){this.map.panBy(e,t)}},{key:"move",value:function(e){this.map.panTo(e)}},{key:"zoom",value:function(e){this.map.setZoom(e)}},{key:"movePoint",value:function(e){this.move(e),this.zoom(this.choseZoom)}},{key:"clearAllMapData",value:function(){this.clearAllMassMarkers(),this.clearAllIconMarkers()}}]),e}();t["a"]=d}}]);